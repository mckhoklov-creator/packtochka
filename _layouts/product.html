---
layout: default
---

{% comment %}
Фото: сначала из front matter (page.images),
если нет — из _data/products.yml по slug.
{% endcomment %}
{% assign product_record = site.data.products | where: "slug", page.slug | first %}
{% assign photo_src = nil %}
{% assign photo_src = page.images | first %}
{% unless photo_src %}
  {% if product_record and product_record.images %}
    {% assign photo_src = product_record.images | first %}
  {% endif %}
{% endunless %}

<nav aria-label="breadcrumb" style="margin:10px 0; font-size:.95rem;">
  <a href="{{ '/' | relative_url }}">Главная</a> ›
  <a href="{{ '/katalog/' | relative_url }}">Каталог</a> ›
  <a href="{{ ('/katalog/' | append: page.category | append: '/') | relative_url }}">
    {% case page.category %}
      {% when "korobki" %}Коробки
      {% when "pakety" %}Пакеты
      {% when "skotch" %}Скотч
      {% when "plenka" %}Плёнка
      {% when "prochie" %}Прочее
      {% else %}Категория
    {% endcase %}
  </a> ›
  <span aria-current="page">{{ page.name }}</span>
</nav>

<article class="product" style="display:grid;grid-template-columns:1fr 1fr;gap:20px;">
  <div>
    {% if photo_src %}
      <img src="{{ photo_src | relative_url }}" alt="{{ page.name }}" style="width:100%;border-radius:10px;">
    {% endif %}
  </div>

  <div>
    <h1>{{ page.name }}</h1>
    <p style="font-size:1.2rem;color:#1a237e;font-weight:700">{{ page.price }} {{ page.unit }}</p>
    {% if page.min_qty %}<p>Минимальный заказ: {{ page.min_qty }}</p>{% endif %}
    <p>{{ page.short }}</p>

    <button class="btn btn-gradient add-to-cart"
            data-sku="{{ page.sku }}"
            data-name="{{ page.name }}"
            data-price="{{ page.price }}">
      Добавить в корзину
    </button>

    <div style="margin-top:20px;">
      <a href="{{ ('/katalog/' | append: page.category | append: '/') | relative_url }}" style="margin-right:12px;">← Вернуться в категорию</a>
      <a href="{{ '/katalog/' | relative_url }}">Каталог</a>
    </div>
  </div>
</article>

<section class="mt-5">
  <h2>С этим покупают</h2>
  <div class="grid">
    {% assign related = site.data.products | where_exp: "item", "item.category != page.category" | sample: 4 %}
    {% for p in related %}
      <div class="card">
        <a href="{{ ('/katalog/' | append: p.category | append: '/' | append: p.slug | append: '/') | relative_url }}">
          <img src="{{ (p.images | first) | relative_url }}" alt="{{ p.name }}">
          <h3>{{ p.name }}</h3>
        </a>
        <p class="price">{{ p.price }} {{ p.unit }}</p>
        <button class="btn btn-gradient mt-2 add-to-cart"
                data-sku="{{ p.sku }}"
                data-name="{{ p.name }}"
                data-price="{{ p.price }}">
          В корзину
        </button>
      </div>
    {% endfor %}
  </div>
</section>
